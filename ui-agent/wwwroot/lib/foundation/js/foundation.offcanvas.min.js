/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/foundation-sites@6.6.3/js/foundation.offcanvas.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";import $ from"jquery";import{Plugin}from"./foundation.core.plugin";import{onLoad,transitionend,RegExpEscape}from"./foundation.core.utils";import{Keyboard}from"./foundation.util.keyboard";import{MediaQuery}from"./foundation.util.mediaQuery";import{Triggers}from"./foundation.util.triggers";class OffCanvas extends Plugin{_setup(t,s){this.className="OffCanvas",this.$element=t,this.options=$.extend({},OffCanvas.defaults,this.$element.data(),s),this.contentClasses={base:[],reveal:[]},this.$lastTrigger=$(),this.$triggers=$(),this.position="left",this.$content=$(),this.nested=!!this.options.nested,this.$sticky=$(),this.isInCanvas=!1,$(["push","overlap"]).each((t,s)=>{this.contentClasses.base.push("has-transition-"+s)}),$(["left","right","top","bottom"]).each((t,s)=>{this.contentClasses.base.push("has-position-"+s),this.contentClasses.reveal.push("has-reveal-"+s)}),Triggers.init($),MediaQuery._init(),this._init(),this._events(),Keyboard.register("OffCanvas",{ESCAPE:"close"})}_init(){var t=this.$element.attr("id");if(this.$element.attr("aria-hidden","true"),this.options.contentId?this.$content=$("#"+this.options.contentId):this.$element.siblings("[data-off-canvas-content]").length?this.$content=this.$element.siblings("[data-off-canvas-content]").first():this.$content=this.$element.closest("[data-off-canvas-content]").first(),this.options.contentId?this.options.contentId&&null===this.options.nested&&console.warn("Remember to use the nested option if using the content ID option!"):this.nested=0===this.$element.siblings("[data-off-canvas-content]").length,!0===this.nested&&(this.options.transition="overlap",this.$element.removeClass("is-transition-push")),this.$element.addClass(`is-transition-${this.options.transition} is-closed`),this.$triggers=$(document).find('[data-open="'+t+'"], [data-close="'+t+'"], [data-toggle="'+t+'"]').attr("aria-expanded","false").attr("aria-controls",t),this.position=this.$element.is(".position-left, .position-top, .position-right, .position-bottom")?this.$element.attr("class").match(/position\-(left|top|right|bottom)/)[1]:this.position,!0===this.options.contentOverlay){var s=document.createElement("div"),e="fixed"===$(this.$element).css("position")?"is-overlay-fixed":"is-overlay-absolute";s.setAttribute("class","js-off-canvas-overlay "+e),this.$overlay=$(s),"is-overlay-fixed"===e?$(this.$overlay).insertAfter(this.$element):this.$content.append(this.$overlay)}var i=new RegExp(RegExpEscape(this.options.revealClass)+"([^\\s]+)","g").exec(this.$element[0].className);i&&(this.options.isRevealed=!0,this.options.revealOn=this.options.revealOn||i[1]),!0===this.options.isRevealed&&this.options.revealOn&&(this.$element.first().addClass(`${this.options.revealClass}${this.options.revealOn}`),this._setMQChecker()),this.options.transitionTime&&this.$element.css("transition-duration",this.options.transitionTime),this.$sticky=this.$content.find("[data-off-canvas-sticky]"),this.$sticky.length>0&&"push"===this.options.transition&&(this.options.contentScroll=!1);let o=this.$element.attr("class").match(/\bin-canvas-for-(\w+)/);o&&2===o.length?this.options.inCanvasOn=o[1]:this.options.inCanvasOn&&this.$element.addClass(`in-canvas-for-${this.options.inCanvasOn}`),this.options.inCanvasOn&&this._checkInCanvas(),this._removeContentClasses()}_events(){(this.$element.off(".zf.trigger .zf.offCanvas").on({"open.zf.trigger":this.open.bind(this),"close.zf.trigger":this.close.bind(this),"toggle.zf.trigger":this.toggle.bind(this),"keydown.zf.offCanvas":this._handleKeyboard.bind(this)}),!0===this.options.closeOnClick)&&(this.options.contentOverlay?this.$overlay:this.$content).on({"click.zf.offCanvas":this.close.bind(this)});this.options.inCanvasOn&&$(window).on("changed.zf.mediaquery",()=>{this._checkInCanvas()})}_setMQChecker(){var t=this;this.onLoadListener=onLoad($(window),function(){MediaQuery.atLeast(t.options.revealOn)&&t.reveal(!0)}),$(window).on("changed.zf.mediaquery",function(){MediaQuery.atLeast(t.options.revealOn)?t.reveal(!0):t.reveal(!1)})}_checkInCanvas(){this.isInCanvas=MediaQuery.atLeast(this.options.inCanvasOn),!0===this.isInCanvas&&this.close()}_removeContentClasses(t){"boolean"!=typeof t?this.$content.removeClass(this.contentClasses.base.join(" ")):!1===t&&this.$content.removeClass(`has-reveal-${this.position}`)}_addContentClasses(t){this._removeContentClasses(t),"boolean"!=typeof t?this.$content.addClass(`has-transition-${this.options.transition} has-position-${this.position}`):!0===t&&this.$content.addClass(`has-reveal-${this.position}`)}_fixStickyElements(){this.$sticky.each((t,s)=>{const e=$(s);if("fixed"===e.css("position")){let t=parseInt(e.css("top"),10);e.data("offCanvasSticky",{top:t});let s=$(document).scrollTop()+t;e.css({top:`${s}px`,width:"100%",transition:"none"})}})}_unfixStickyElements(){this.$sticky.each((t,s)=>{const e=$(s);let i=e.data("offCanvasSticky");"object"==typeof i&&(e.css({top:`${i.top}px`,width:"",transition:""}),e.data("offCanvasSticky",""))})}reveal(t){t?(this.close(),this.isRevealed=!0,this.$element.attr("aria-hidden","false"),this.$element.off("open.zf.trigger toggle.zf.trigger"),this.$element.removeClass("is-closed")):(this.isRevealed=!1,this.$element.attr("aria-hidden","true"),this.$element.off("open.zf.trigger toggle.zf.trigger").on({"open.zf.trigger":this.open.bind(this),"toggle.zf.trigger":this.toggle.bind(this)}),this.$element.addClass("is-closed")),this._addContentClasses(t)}_stopScrolling(t){return!1}_recordScrollable(t){let s=this;s.scrollHeight!==s.clientHeight&&(0===s.scrollTop&&(s.scrollTop=1),s.scrollTop===s.scrollHeight-s.clientHeight&&(s.scrollTop=s.scrollHeight-s.clientHeight-1)),s.allowUp=s.scrollTop>0,s.allowDown=s.scrollTop<s.scrollHeight-s.clientHeight,s.lastY=t.originalEvent.pageY}_stopScrollPropagation(t){let s,e=this,i=t.pageY<e.lastY,o=!i;e.lastY=t.pageY,i&&e.allowUp||o&&e.allowDown?(t.stopPropagation(),e.hasAttribute("data-off-canvas-scrollbox")&&(s=e.closest("[data-off-canvas], [data-off-canvas-scrollbox-outer]"),e.scrollTop<=1&&s.scrollTop>0?s.scrollTop--:e.scrollTop>=e.scrollHeight-e.clientHeight-1&&s.scrollTop<s.scrollHeight-s.clientHeight&&s.scrollTop++)):t.preventDefault()}open(t,s){if(!(this.$element.hasClass("is-open")||this.isRevealed||this.isInCanvas)){var e=this;s&&(this.$lastTrigger=s),"top"===this.options.forceTo?window.scrollTo(0,0):"bottom"===this.options.forceTo&&window.scrollTo(0,document.body.scrollHeight),this.options.transitionTime&&"overlap"!==this.options.transition?this.$element.siblings("[data-off-canvas-content]").css("transition-duration",this.options.transitionTime):this.$element.siblings("[data-off-canvas-content]").css("transition-duration",""),this.$element.addClass("is-open").removeClass("is-closed"),this.$triggers.attr("aria-expanded","true"),this.$element.attr("aria-hidden","false"),this.$content.addClass("is-open-"+this.position),!1===this.options.contentScroll&&($("body").addClass("is-off-canvas-open").on("touchmove",this._stopScrolling),this.$element.on("touchstart",this._recordScrollable),this.$element.on("touchmove",this._stopScrollPropagation),this.$element.on("touchstart","[data-off-canvas-scrollbox]",this._recordScrollable),this.$element.on("touchmove","[data-off-canvas-scrollbox]",this._stopScrollPropagation)),!0===this.options.contentOverlay&&this.$overlay.addClass("is-visible"),!0===this.options.closeOnClick&&!0===this.options.contentOverlay&&this.$overlay.addClass("is-closable"),!0===this.options.autoFocus&&this.$element.one(transitionend(this.$element),function(){if(e.$element.hasClass("is-open")){var t=e.$element.find("[data-autofocus]");t.length?t.eq(0).focus():e.$element.find("a, button").eq(0).focus()}}),!0===this.options.trapFocus&&(this.$content.attr("tabindex","-1"),Keyboard.trapFocus(this.$element)),"push"===this.options.transition&&this._fixStickyElements(),this._addContentClasses(),this.$element.trigger("opened.zf.offCanvas"),this.$element.one(transitionend(this.$element),()=>{this.$element.trigger("openedEnd.zf.offCanvas")})}}close(t){if(this.$element.hasClass("is-open")&&!this.isRevealed){this.$element.trigger("close.zf.offCanvas");this.$element.removeClass("is-open"),this.$element.attr("aria-hidden","true"),this.$content.removeClass("is-open-left is-open-top is-open-right is-open-bottom"),!0===this.options.contentOverlay&&this.$overlay.removeClass("is-visible"),!0===this.options.closeOnClick&&!0===this.options.contentOverlay&&this.$overlay.removeClass("is-closable"),this.$triggers.attr("aria-expanded","false"),this.$element.one(transitionend(this.$element),t=>{this.$element.addClass("is-closed"),this._removeContentClasses(),"push"===this.options.transition&&this._unfixStickyElements(),!1===this.options.contentScroll&&($("body").removeClass("is-off-canvas-open").off("touchmove",this._stopScrolling),this.$element.off("touchstart",this._recordScrollable),this.$element.off("touchmove",this._stopScrollPropagation),this.$element.off("touchstart","[data-off-canvas-scrollbox]",this._recordScrollable),this.$element.off("touchmove","[data-off-canvas-scrollbox]",this._stopScrollPropagation)),!0===this.options.trapFocus&&(this.$content.removeAttr("tabindex"),Keyboard.releaseFocus(this.$element)),this.$element.trigger("closed.zf.offCanvas")})}}toggle(t,s){this.$element.hasClass("is-open")?this.close(t,s):this.open(t,s)}_handleKeyboard(t){Keyboard.handleKey(t,"OffCanvas",{close:()=>(this.close(),this.$lastTrigger.focus(),!0),handled:()=>{t.preventDefault()}})}_destroy(){this.close(),this.$element.off(".zf.trigger .zf.offCanvas"),this.$overlay.off(".zf.offCanvas"),this.onLoadListener&&$(window).off(this.onLoadListener)}}OffCanvas.defaults={closeOnClick:!0,contentOverlay:!0,contentId:null,nested:null,contentScroll:!0,transitionTime:null,transition:"push",forceTo:null,isRevealed:!1,revealOn:null,inCanvasOn:null,autoFocus:!0,revealClass:"reveal-for-",trapFocus:!1};export{OffCanvas};
//# sourceMappingURL=/sm/6e0af2d8f923aba4fd117b458f47f0721e60837e4cf5f9666c3bc312178f34fb.map