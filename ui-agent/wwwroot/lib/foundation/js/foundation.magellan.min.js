/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/foundation-sites@6.6.3/js/foundation.magellan.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";import $ from"jquery";import{Plugin}from"./foundation.core.plugin";import{onLoad,GetYoDigits}from"./foundation.core.utils";import{SmoothScroll}from"./foundation.smoothScroll";import{Triggers}from"./foundation.util.triggers";class Magellan extends Plugin{_setup(t,i){this.$element=t,this.options=$.extend({},Magellan.defaults,this.$element.data(),i),this.className="Magellan",Triggers.init($),this._init(),this.calcPoints()}_init(){var t=this.$element[0].id||GetYoDigits(6,"magellan");this.$targets=$("[data-magellan-target]"),this.$links=this.$element.find("a"),this.$element.attr({"data-resize":t,"data-scroll":t,id:t}),this.$active=$(),this.scrollPos=parseInt(window.pageYOffset,10),this._events()}calcPoints(){var t=this,i=document.body,e=document.documentElement;this.points=[],this.winHeight=Math.round(Math.max(window.innerHeight,e.clientHeight)),this.docHeight=Math.round(Math.max(i.scrollHeight,i.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight)),this.$targets.each(function(){var i=$(this),e=Math.round(i.offset().top-t.options.threshold);i.targetPoint=e,t.points.push(e)})}_events(){var t=this;$(window).one("load",function(){t.options.deepLinking&&location.hash&&t.scrollToLoc(location.hash),t.calcPoints(),t._updateActive()}),t.onLoadListener=onLoad($(window),function(){t.$element.on({"resizeme.zf.trigger":t.reflow.bind(t),"scrollme.zf.trigger":t._updateActive.bind(t)}).on("click.zf.magellan",'a[href^="#"]',function(i){i.preventDefault();var e=this.getAttribute("href");t.scrollToLoc(e)})}),this._deepLinkScroll=function(i){t.options.deepLinking&&t.scrollToLoc(window.location.hash)},$(window).on("hashchange",this._deepLinkScroll)}scrollToLoc(t){this._inTransition=!0;var i=this,e={animationEasing:this.options.animationEasing,animationDuration:this.options.animationDuration,threshold:this.options.threshold,offset:this.options.offset};SmoothScroll.scrollToLoc(t,e,function(){i._inTransition=!1})}reflow(){this.calcPoints(),this._updateActive()}_updateActive(){if(this._inTransition)return;const t=parseInt(window.pageYOffset,10),i=this.scrollPos>t;let e;if(this.scrollPos=t,t<this.points[0]);else if(t+this.winHeight===this.docHeight)e=this.points.length-1;else{const o=this.points.filter((e,o)=>e-this.options.offset-(i?this.options.threshold:0)<=t);e=o.length?o.length-1:0}const o=this.$active;let s="";void 0!==e?(this.$active=this.$links.filter('[href="#'+this.$targets.eq(e).data("magellan-target")+'"]'),this.$active.length&&(s=this.$active[0].getAttribute("href"))):this.$active=$();const n=!(!this.$active.length&&!o.length||this.$active.is(o)),a=s!==window.location.hash;if(n&&(o.removeClass(this.options.activeClass),this.$active.addClass(this.options.activeClass)),this.options.deepLinking&&a)if(window.history.pushState){const t=s||window.location.pathname+window.location.search;this.options.updateHistory?window.history.pushState({},"",t):window.history.replaceState({},"",t)}else window.location.hash=s;n&&this.$element.trigger("update.zf.magellan",[this.$active])}_destroy(){if(this.$element.off(".zf.trigger .zf.magellan").find(`.${this.options.activeClass}`).removeClass(this.options.activeClass),this.options.deepLinking){var t=this.$active[0].getAttribute("href");window.location.hash.replace(t,"")}$(window).off("hashchange",this._deepLinkScroll),this.onLoadListener&&$(window).off(this.onLoadListener)}}Magellan.defaults={animationDuration:500,animationEasing:"linear",threshold:50,activeClass:"is-active",deepLinking:!1,updateHistory:!1,offset:0};export{Magellan};
//# sourceMappingURL=/sm/d61c4b9d3eeec8cd8f8b707f9d1b947125672f4b86e1a44df28212b19b3984b2.map